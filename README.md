## Flutter MindMate

A modern, modular, and sustainable Flutter application. The project uses powerful code generation, strict code standards, scalable modular structure, and secure configurations. MindMate also serves as a personal “mentor”: it can be used like a daily journal, helps users find answers to their questions, gain insights, and reflect their emotions throughout the day.

> Important: Answers are generated using the OpenAI API; the mobile app includes an AI integration.

## Features
- Speech input and speech-to-text, plus text-to-speech
- AI assistant: Responses are generated via the OpenAI API (LLM-based guidance)
- Authentication: Email/password sign-in and one‑tap Google sign‑in
- Password reset: Send reset link via email
- Daily mood-related reminders/notifications
- Periodic mood tracking with charts (trends/statistics)
- Conversation history with contextual recall
- Profile image upload: Select and upload profile pictures via image picker
- Multi-language support: Turkish and English character support in message inputs
- Local/remote notifications, permission handling, and tap actions
- Modular feature architecture with Provider-based state management
- Extensible service layer and dependency injection with `get_it`
- Responsive UI via `responsive_framework` and customizable AppBars

## Screens

<table>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/28905e04-1dd8-4139-a649-470eb5925af6" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/b7f19ede-3981-4615-adde-7d52fd74fd15" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/1bf54f20-426e-4629-8d19-e226ffe575b6" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/09e27d49-be28-4d3f-8f0d-87cad5727c16" width="200"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/a948730f-c39d-46da-935d-df9ae483eb48" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/21c5f561-b8aa-4f80-ab98-4ea898d782d4" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/51818704-0769-4fac-afff-331b54c17ce7" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/1453d43b-1c38-4164-8943-41018b34deb1" width="200"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/6410ce41-08f6-440f-9a45-905d9f0adba2" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/158c70c5-be33-465c-8672-0144870308ed" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/7fa613da-1cbd-4a34-bd28-528d5a33072f" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/7d082f3f-6ac8-49a7-be27-9760086abe6c" width="200"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/c507bd05-2c52-4a62-b95f-d869d0b6dfb7" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/0a6c6c00-ea50-4cde-9f2f-bb55babe2a1f" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/97e57506-5309-4ba1-a202-63a82f286b07" width="200"></td>
    <td><img src="https://github.com/user-attachments/assets/081e9f5d-ac09-45f9-a53f-4babe8a46554" width="200"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/c348bc7f-690c-4329-b9fe-b303cf10ddea" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/83cf63d7-4dd7-4eb9-ba02-87e30ebc4c1c" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/cf873e2f-7d56-4d84-a9d1-3e64ffcd170b" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/34251db6-f537-4e54-a552-423012187cec" width="100"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/6b513e90-6164-4aa7-9bd4-0e5fc3fe1bc6" width=100"></td>
    <td><img src="https://github.com/user-attachments/assets/b3da89d0-5fc7-45bd-ab28-9fdd15415539" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/1bf51cb2-64e0-4847-9af9-02062dbff272" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/d2b9a580-380c-4040-a4f4-e13c6db546a0" width="100"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/a7cf0872-2d27-43f9-9f40-20c78f67c296" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/cb47c35d-b7e6-4a12-9dd9-46e916b7d641" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/9b99457a-733c-417a-b1f7-ef5d4d42bde1" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/49795c93-de45-4bd6-8699-4bc52094d8e3" width="100"></td>
  </tr>
  <tr>
    <td><img src="https://github.com/user-attachments/assets/19c74fc7-05ea-43f4-a37c-cbd326eff1d3" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/f0283be3-c32e-4842-b94c-6ee3571a10e2" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/66777628-2a9a-4b0c-8564-c4f552e2d950" width="100"></td>
    <td><img src="https://github.com/user-attachments/assets/87572f29-0cb7-46ab-a9ca-56772d24a1d7" width="100"></td>
  </tr>
</table>


### Table of Contents
- Project Overview
- Architecture & Directory Structure
- Commands & Automation (rps)
- Code Generation & Asset Management
- Environment Variables & Security
- State Management & Layers
- UI & Design Guidelines
- Logging & Error Handling
- Lint Rules & Code Standards
- Technologies & Packages
- AI Integration (OpenAI API)
- Notification Service (NotificationService)
- Flutter Version Management (Sidekick)
- build.yaml Configuration
---

## Project Overview
MindMate is a Flutter app where features are modularized under `features/`, services are grouped under `products/`, dependencies are managed with `get_it`, and resources are auto-generated via `flutter_gen_runner`. Hardcoded strings and numeric constants are avoided; strings live in `enums/strings_enum.dart` and sizes in `products/enums/sizes_enum.dart` as enhanced enums. The app generates answers using the OpenAI API, providing an AI integration for mobile. User experience is bilingual: message inputs and AI yanıtları hem Türkçe hem İngilizce karakterleri destekler, kullanıcı hangi dilde yazarsa uygulama da aynı dilde karşılık verir.

---

## Architecture & Directory Structure
Example layout:

```
lib/
  features/
    <feature_name>/
      view/
        <feature_name>_view.dart         // UI tree only
      sub_view/
        <extracted_widgets>.dart         // Extracted UI parts
      view_model/
        <feature_name>_view_model.dart   // Business logic, state, services
      provider/
        <feature_name>_provider.dart     // Provider definitions (ref usage only in VM)

  products/
    appbars/
      <custom_appbars>.dart
    enums/
      sizes_enum.dart                    // ImageSizesEnum, TextSizesEnum, IconSizesEnum, WidgetSizesEnum, AppbarSizesEnum (enhanced enums)
      strings_enum.dart                  // Centralized strings
    services/
      notification_service.dart          // Notifications & permissions

  service_locator/
    service_locator.dart                 // get_it registrations

gen/                                      // flutter_gen outputs

assets/
  images/ ...
  colors/colors.xml                       // Colors (optional)
```

Key principles:
- `view.dart` files hold UI only. Business logic, validation, services and state live in `view_model/` or `provider/`.
- Access model: Providers are accessed only via `ref` and only from ViewModel. UI focuses on presentation.
- AppBars are extracted and placed under `products/appbars/`.

---

## Commands & Automation (rps)
Frequently used commands are shortened via `rps.yaml`. Suggested scripts:

```yaml
scripts:
  gen_flutter: flutter pub run build_runner build --delete-conflicting-outputs
  gen_watch: flutter pub run build_runner watch --delete-conflicting-outputs
  pub_get: flutter pub get
  analyze: flutter analyze
  format: dart format lib test
```

Usage:
```
rps run gen_flutter
rps run gen_watch
rps run analyze
```

Required rules:
- Whenever code generation is affected: run `rps run gen_flutter`.
- When anything under `assets/` changes: run `rps run gen_flutter`.

---

## Code Generation & Asset Management
- Resources (assets, colors, fonts, images) are managed with `flutter_gen_runner`, generating code under `gen/`.
- JSON Serializable runs only for `lib/models/**_model.dart` files.
- Each package in `pubspec.yaml` should have a short comment prefix.

---

## Environment Variables & Security
- API keys and secrets live in `.env` files, never hardcoded.
- Variables are managed via `envied` for type-safe access.
- Do not commit `.env` files to VCS.

### Environment Files Setup
The project uses different environment files for debug and production modes:
- **Debug mode**: Uses `.env` file (development API keys)
- **Production mode**: Uses `.env.production` file (production API keys)

The app automatically loads the correct file based on the build mode:
- Debug builds → `.env`
- Release builds → `.env.production`

### Setup Instructions
1. Create `.env` file for development (debug mode)
2. Create `.env.production` file for production (release mode)
3. Fill both files with appropriate API keys and secrets
4. Run `rps run gen_flutter` after creating/updating `.env` files for codegen

**Important**: Never commit `.env` or `.env.production` files to version control. Add them to `.gitignore`.

Example `.env` (development):
```
OPENAI_API_KEY=sk-dev-...
FIREBASE_KEY=...
API_BASE_URL=https://api-dev.example.com
```

Example `.env.production` (production):
```
OPENAI_API_KEY=sk-prod-...
FIREBASE_KEY=...
API_BASE_URL=https://api.example.com
```

---

## State Management & Layers
- State management is done with Provider.
- Providers are accessed via `ref` only in the ViewModel; the UI renders data and forwards interactions.
- Throwing is allowed only in ViewModel/Service layers (to be handled above). Never throw from UI.

---

## UI & Design Guidelines
- Responsive layout via `responsive_framework` with breakpoints in `main.dart`.
- No hardcoded strings. All texts live in `products/enums/strings_enum.dart`.
- No hardcoded numeric sizes. Define all sizes as enhanced enums in `products/enums/sizes_enum.dart`:
  - `ImageSizesEnum`
  - `TextSizesEnum`
  - `IconSizesEnum`
  - `WidgetSizesEnum`
  - `AppbarSizesEnum`
- Only create enums for the requested type.

Colors:
- Optionally manage colors in `assets/colors/colors.xml` and access via `flutter_gen`.

AppBars:
- Extract AppBars and place them under `products/appbars/`.

---

## Logging & Error Handling
- Avoid `print`; use a centralized logging approach.
- Wrap critical/crash-prone code in `try-catch`.
- Only throw from ViewModel/Service layers (to be handled by upper layers); never from UI.

---

## Lint Rules & Code Standards
Enable the following in `analysis_options.yaml` (summary):
- `flutter_lints`
- `always_declare_return_types: true`
- `always_put_required_named_parameters_first: true`
- `always_require_non_null_named_parameters: true`
- `always_use_package_imports: true`
- `avoid_print: true`
- `prefer_final_locals: true`
- `avoid_empty_else: true`
- `sort_constructors_first: true`
- `use_super_parameters: true`

Coding guidelines:
- Prefer clear, meaningful names over cryptic ones.
- Keep business logic in ViewModel/Service; UI is presentation-only.
- Manage dependencies via `get_it` in `service_locator/service_locator.dart`.

Note: Team-wide development standards (“Cursor rules”) are defined in a separate guide to avoid duplication here.

---

## Technologies & Packages
- dart_openai: OpenAI API client (LLM-based response generation)
- Flutter & Dart: Cross-platform UI development
- Riverpod 3 (`riverpod`, `flutter_riverpod`): State management; `ref` access only in ViewModel
- get_it: Dependency injection (`service_locator/service_locator.dart`)
- responsive_framework: Adaptive UI for mobile/tablet/web/desktop
- flutter_gen_runner + build_runner: Codegen for assets/colors/fonts (`gen/`)
- json_serializable + json_annotation: `g.dart` generation (only for `lib/models/**_model.dart`)
- envied: Type-safe environment variable management
- flutter_dotenv: Load .env files (when needed)
- dio: HTTP client
- connectivity_plus: Network status
- permission_handler: Permissions
- image_picker: Image selection from gallery for profile pictures
- url_launcher: External links/app launching
- flutter_local_notifications + timezone: Local notifications & scheduling
- fl_chart: Charts and mood trends
- equatable: Value equality helpers
- kartal: Utility extensions
- Firebase: `firebase_core`, `cloud_firestore`, `firebase_auth`, `firebase_storage`, `firebase_ui_auth`, `firebase_ui_oauth_google`, `firebase_ui_localizations`, `google_sign_in`
- Flutter Sidekick: Pin Flutter version/channel (recommended)
- Maestro: UI test automation

Note: See `pubspec.yaml` for versions and comments.

---

## Firebase Integration
The app uses Firebase as the backend infrastructure for authentication, data storage, and file storage.

### Firebase Services Used

#### 1. Firebase Authentication (`firebase_auth`)
- **Email/Password Authentication**: User sign-up, sign-in, and password reset
- **Google Sign-In**: One-tap Google authentication via `firebase_ui_oauth_google`
- **Security**: Password reset emails don't reveal if an email exists (prevents email enumeration attacks)
- **Re-authentication**: Required for sensitive operations (password/email changes)

#### 2. Cloud Firestore (`cloud_firestore`)
- **Messages Collection**: Stores user messages, AI responses, dates, times, and mood emojis
- **Images Collection**: Stores user profile image URLs
- **Notifications Collection**: Stores notification preferences and scheduling data
- **Structure**: Collections organized by user ID for data isolation

#### 3. Firebase Storage (`firebase_storage`)
- **Profile Images**: Uploads and stores user profile pictures
- **Path Structure**: `profile_images/{userId}/{timestamp}.jpg`
- **Image Service**: Handles upload, download URL generation, and Firestore URL storage

#### 4. Firebase UI (`firebase_ui_auth`, `firebase_ui_oauth_google`)
- **Pre-built UI Components**: Authentication screens and Google sign-in buttons
- **Localization**: Multi-language support via `firebase_ui_localizations`

### Firebase Configuration
- Configuration files: `android/app/google-services.json` (Android)
- Environment variables: API keys stored in `.env` files (not committed to VCS)
- Initialization: Firebase initialized in `AppInitiliazer` before app start

---

## Image Picker & Profile Management
- **Package**: `image_picker` (v1.2.0)
- **Usage**: Profile picture selection from device gallery
- **Features**:
  - Gallery image selection
  - Image quality optimization (80% quality)
  - Upload to Firebase Storage
  - URL storage in Firestore
  - Automatic image loading on profile screen
- **Implementation**: `lib/features/profile/view_model/profile_view_model.dart`
- **Service**: `lib/products/services/image_service.dart` handles Firebase Storage uploads

---

## Time Period Logic (Morning/Afternoon/Evening)
The app automatically categorizes messages by time period based on the current hour:

- **Morning**: 00:00 - 11:59 (hour < 12)
- **Afternoon**: 12:00 - 17:59 (hour >= 12 && hour < 18)
- **Evening**: 18:00 - 23:59 (hour >= 18)

**Implementation**: `lib/features/message/provider/message_provider.dart` - `_getPeriodFromDateTime()` method

The time period is displayed alongside messages in the history view and is used for organizing conversations by day and period.

---

## Multi-Language Support
- **Message Input**: Supports Turkish characters (ı, ö, ü, ş, ğ, ç) and English characters
- **No Input Restrictions**: Message input fields don't use `FilteringTextInputFormatter`, allowing full Unicode character support
- **AI Responses**: AI responds in the same language as the user's input (Turkish or English)
- **Localization**: UI strings managed via `products/enums/strings_enum.dart`

---

## AI Integration (OpenAI API)
- Purpose: Provide smart, contextual, and empathetic responses to users
- Backend: Responses are generated using the OpenAI API (LLM)
- Security: API keys are stored in `.env` and accessed via `envied`; never hardcoded
- Data: Minimal data is sent; conversation history context is used with consent and privacy in mind
- Resilience: Network failures are handled gracefully with user feedback; critical code is wrapped in `try-catch`

Note: Do not share production keys; monitor usage/limits in the OpenAI dashboard.

---

## Flutter Version Management (Sidekick)
- Pin a Flutter version with Sidekick before development to align SDK across the team.
- Choose a channel (stable/beta) and a specific version if needed.

Setup: Install Sidekick, register the project, pin the version, then verify with `flutter --version`.

---

## build.yaml Configuration
Run `json_serializable` only for `lib/models/*_model.dart`. Example configuration:

```yaml
targets:
  $default:
    sources:
      include:
        - lib/**
    builders:
      json_serializable:
        generate_for:
          include:
            - lib/models/**_model.dart
```

This optimizes build time and prevents `g.dart` generation for unwanted files.

---

## Notification Service (NotificationService)
File: `lib/products/services/notification_service.dart`

Capabilities:
- Permissions flow & status checks
- Scheduling/showing local (and/or push) notifications
- Behavior when app is foreground/background

---
